
; PICBASIC PRO(TM) Compiler 3.0.1.1, (c) 1998, 2011 microEngineering Labs, Inc. All Rights Reserved. 
MPASMX_USED			EQU	1

#define	PBP_PATH	C:\PROGRAM FILES (X86)\PBP3\




        NOLIST
    ifdef PM_USED
        LIST
        include 'M16F684.INC'	; PM header
        XALL
        NOLIST
    else
        LIST
        LIST p = 16F684, r = dec, w = -302, c = 255
        INCLUDE "P16F684.INC"	; MPASM  Header
        NOLIST
    endif
        LIST


PBP_HARDWAREDEF  macro
  endm


    __config _INTRC_OSC_NOCLKOUT & _WDT_ON & _MCLRE_ON & _CP_OFF



; Define statements.
; C:\PROGRAM FILES (X86)\PBP3\DEVICES\PIC16F684.PBPINC	00149	DEFINE	CCP1_REG PORTC
#define		CCP1_REG		 PORTC
; C:\PROGRAM FILES (X86)\PBP3\DEVICES\PIC16F684.PBPINC	00150	DEFINE	CCP1_BIT 5
#define		CCP1_BIT		 5
; C:\USERS\DMITR\DOCUMENTS\GITHUB\UMAB\UMAB_V0_4A_RELEASE.PBP	00008	DEFINE OSC 8
#define		OSC		 8

RAM_START       		EQU	00020h
RAM_END         		EQU	000BFh
RAM_BANKS       		EQU	00002h
BANK0_START     		EQU	00020h
BANK0_END       		EQU	0007Fh
BANK1_START     		EQU	000A0h
BANK1_END       		EQU	000BFh
EEPROM_START    		EQU	02100h
EEPROM_END      		EQU	021FFh

; C:\PROGRAM FILES (X86)\PBP3\PBPPIC14.RAM	00012	A00020	R0      VAR     WORD BANK0 SYSTEM       ' System Register
R0              		EQU	RAM_START + 000h
; C:\PROGRAM FILES (X86)\PBP3\PBPPIC14.RAM	00013	A00022	R1      VAR     WORD BANK0 SYSTEM       ' System Register
R1              		EQU	RAM_START + 002h
; C:\PROGRAM FILES (X86)\PBP3\PBPPIC14.RAM	00014	A00024	R2      VAR     WORD BANK0 SYSTEM       ' System Register
R2              		EQU	RAM_START + 004h
; C:\PROGRAM FILES (X86)\PBP3\PBPPIC14.RAM	00015	A00026	R3      VAR     WORD BANK0 SYSTEM       ' System Register
R3              		EQU	RAM_START + 006h
; C:\PROGRAM FILES (X86)\PBP3\PBPPIC14.RAM	00016	A00028	R4      VAR     WORD BANK0 SYSTEM       ' System Register
R4              		EQU	RAM_START + 008h
; C:\PROGRAM FILES (X86)\PBP3\PBPPIC14.RAM	00017	A0002A	R5      VAR     WORD BANK0 SYSTEM       ' System Register
R5              		EQU	RAM_START + 00Ah
; C:\PROGRAM FILES (X86)\PBP3\PBPPIC14.RAM	00018	A0002C	R6      VAR     WORD BANK0 SYSTEM       ' System Register
R6              		EQU	RAM_START + 00Ch
; C:\PROGRAM FILES (X86)\PBP3\PBPPIC14.RAM	00019	A0002E	R7      VAR     WORD BANK0 SYSTEM       ' System Register
R7              		EQU	RAM_START + 00Eh
; C:\PROGRAM FILES (X86)\PBP3\PBPPIC14.RAM	00020	A00030	R8      VAR     WORD BANK0 SYSTEM       ' System Register
R8              		EQU	RAM_START + 010h
; C:\PROGRAM FILES (X86)\PBP3\PBPPIC14.RAM	00026	A00032	FLAGS   VAR     BYTE BANK0 SYSTEM       ' Static flags
FLAGS           		EQU	RAM_START + 012h
; C:\PROGRAM FILES (X86)\PBP3\PBPPIC14.RAM	00025	A00033	GOP     VAR     BYTE BANK0 SYSTEM       ' Gen Op Parameter
GOP             		EQU	RAM_START + 013h
; C:\PROGRAM FILES (X86)\PBP3\PBPPIC14.RAM	00022	A00034	RM1     VAR     BYTE BANK0 SYSTEM       ' Pin 1 Mask
RM1             		EQU	RAM_START + 014h
; C:\PROGRAM FILES (X86)\PBP3\PBPPIC14.RAM	00024	A00035	RM2     VAR     BYTE BANK0 SYSTEM       ' Pin 2 Mask
RM2             		EQU	RAM_START + 015h
; C:\PROGRAM FILES (X86)\PBP3\PBPPIC14.RAM	00021	A00036	RR1     VAR     BYTE BANK0 SYSTEM       ' Pin 1 Register
RR1             		EQU	RAM_START + 016h
; C:\PROGRAM FILES (X86)\PBP3\PBPPIC14.RAM	00023	A00037	RR2     VAR     BYTE BANK0 SYSTEM       ' Pin 2 Register
RR2             		EQU	RAM_START + 017h
; C:\USERS\DMITR\DOCUMENTS\GITHUB\UMAB\UMAB_V0_4A_RELEASE.PBP	00001	A00038	'MILES TAG
T1              		EQU	RAM_START + 018h
; C:\USERS\DMITR\DOCUMENTS\GITHUB\UMAB\UMAB_V0_4A_RELEASE.PBP	00001	A0003A	'MILES TAG
T2              		EQU	RAM_START + 01Ah
; C:\USERS\DMITR\DOCUMENTS\GITHUB\UMAB\UMAB_V0_4A_RELEASE.PBP	00046	A0003C	addr			var byte	'Адрес записи значений в ЕЕПРОМ
_addr            		EQU	RAM_START + 01Ch
; C:\USERS\DMITR\DOCUMENTS\GITHUB\UMAB\UMAB_V0_4A_RELEASE.PBP	00035	A0003D	AMOUNT          	var byte	'Временная переменная для количества
_AMOUNT          		EQU	RAM_START + 01Dh
; C:\USERS\DMITR\DOCUMENTS\GITHUB\UMAB\UMAB_V0_4A_RELEASE.PBP	00055	A0003E	AMOUNT_AIDKIT   	var byte	'
_AMOUNT_AIDKIT   		EQU	RAM_START + 01Eh
; C:\USERS\DMITR\DOCUMENTS\GITHUB\UMAB\UMAB_V0_4A_RELEASE.PBP	00054	A0003F	AMOUNT_AMMO     	var byte	'
_AMOUNT_AMMO     		EQU	RAM_START + 01Fh
; C:\USERS\DMITR\DOCUMENTS\GITHUB\UMAB\UMAB_V0_4A_RELEASE.PBP	00053	A00040	AMOUNT_MED      	var byte	'
_AMOUNT_MED      		EQU	RAM_START + 020h
; C:\USERS\DMITR\DOCUMENTS\GITHUB\UMAB\UMAB_V0_4A_RELEASE.PBP	00026	A00041	bit_counter 		VAR BYTE	
_bit_counter     		EQU	RAM_START + 021h
; C:\USERS\DMITR\DOCUMENTS\GITHUB\UMAB\UMAB_V0_4A_RELEASE.PBP	00057	A00042	CAP_AMMO		var byte	'Кол-во выдаваемых за раз патронов
_CAP_AMMO        		EQU	RAM_START + 022h
; C:\USERS\DMITR\DOCUMENTS\GITHUB\UMAB\UMAB_V0_4A_RELEASE.PBP	00056	A00043	CAP_MED			var byte	'Кол-во выдаваемых за раз жизней
_CAP_MED         		EQU	RAM_START + 023h
; C:\USERS\DMITR\DOCUMENTS\GITHUB\UMAB\UMAB_V0_4A_RELEASE.PBP	00027	A00044	databyte 		VAR BYTE	
_databyte        		EQU	RAM_START + 024h
; C:\USERS\DMITR\DOCUMENTS\GITHUB\UMAB\UMAB_V0_4A_RELEASE.PBP	00043	A00045	def_value		var byte	'Записанное в ЕЕПРОМ значение
_def_value       		EQU	RAM_START + 025h
; C:\USERS\DMITR\DOCUMENTS\GITHUB\UMAB\UMAB_V0_4A_RELEASE.PBP	00051	A00046	flag			var byte	'Кнопка нажата/отпущена
_flag            		EQU	RAM_START + 026h
; C:\USERS\DMITR\DOCUMENTS\GITHUB\UMAB\UMAB_V0_4A_RELEASE.PBP	00042	A00047	INC 			var byte	'Шаг увеличения
_INC             		EQU	RAM_START + 027h
; C:\USERS\DMITR\DOCUMENTS\GITHUB\UMAB\UMAB_V0_4A_RELEASE.PBP	00045	A00048	MAX_value		var byte	'Максимальное значение
_MAX_value       		EQU	RAM_START + 028h
; C:\USERS\DMITR\DOCUMENTS\GITHUB\UMAB\UMAB_V0_4A_RELEASE.PBP	00028	A00049	message         	VAR BYTE
_message         		EQU	RAM_START + 029h
; C:\USERS\DMITR\DOCUMENTS\GITHUB\UMAB\UMAB_V0_4A_RELEASE.PBP	00029	A0004A	message_ID		VAR BYTE
_message_ID      		EQU	RAM_START + 02Ah
; C:\USERS\DMITR\DOCUMENTS\GITHUB\UMAB\UMAB_V0_4A_RELEASE.PBP	00044	A0004B	min_value		var byte	'Минимальное значение
_min_value       		EQU	RAM_START + 02Bh
; C:\USERS\DMITR\DOCUMENTS\GITHUB\UMAB\UMAB_V0_4A_RELEASE.PBP	00052	A0004C	MODE            	VAR BYTE	'Режим работы коробки
_MODE            		EQU	RAM_START + 02Ch
; C:\USERS\DMITR\DOCUMENTS\GITHUB\UMAB\UMAB_V0_4A_RELEASE.PBP	00041	A0004D	RATE            	var byte	'Временная переменная для длительности удержания кнопки
_RATE            		EQU	RAM_START + 02Dh
; C:\USERS\DMITR\DOCUMENTS\GITHUB\UMAB\UMAB_V0_4A_RELEASE.PBP	00060	A0004E	RATE_AIDKIT     	var byte	'Время удержания кнопки в режиме конечной аптечки
_RATE_AIDKIT     		EQU	RAM_START + 02Eh
; C:\USERS\DMITR\DOCUMENTS\GITHUB\UMAB\UMAB_V0_4A_RELEASE.PBP	00061	A0004F	RATE_AIDKIT_INF 	var byte	'Время удержания кнопки в режиме бесконечной аптечки
_RATE_AIDKIT_INF 		EQU	RAM_START + 02Fh
; C:\USERS\DMITR\DOCUMENTS\GITHUB\UMAB\UMAB_V0_4A_RELEASE.PBP	00059	A00050	RATE_AMMO       	var byte	'Время удержания кнопки в режиме Ящик с патронами
_RATE_AMMO       		EQU	RAM_START + 030h
; C:\USERS\DMITR\DOCUMENTS\GITHUB\UMAB\UMAB_V0_4A_RELEASE.PBP	00058	A00051	RATE_MED        	var byte	'Время удержания кнопки в режиме Медика
_RATE_MED        		EQU	RAM_START + 031h
; C:\USERS\DMITR\DOCUMENTS\GITHUB\UMAB\UMAB_V0_4A_RELEASE.PBP	00050	A00052	setup			var byte	'0 - обычный режим; 1 - режим настройки
_setup           		EQU	RAM_START + 032h
; C:\USERS\DMITR\DOCUMENTS\GITHUB\UMAB\UMAB_V0_4A_RELEASE.PBP	00033	A00053	TEMP			VAR BYTE	'Временная переменная для всего
_TEMP            		EQU	RAM_START + 033h
; C:\USERS\DMITR\DOCUMENTS\GITHUB\UMAB\UMAB_V0_4A_RELEASE.PBP	00034	A00054	TEMP2			var byte	'Временная переменная для вывода значения на индикаторы
_TEMP2           		EQU	RAM_START + 034h
; C:\USERS\DMITR\DOCUMENTS\GITHUB\UMAB\UMAB_V0_4A_RELEASE.PBP	00036	A00055	temp_amount		var byte	'Временная переменная
_temp_amount     		EQU	RAM_START + 035h
; C:\PROGRAM FILES (X86)\PBP3\DEVICES\PIC16F684.PBPINC	00137	PORTL   VAR     PORTA
_PORTL           		EQU	 PORTA
; C:\PROGRAM FILES (X86)\PBP3\DEVICES\PIC16F684.PBPINC	00138	PORTH   VAR     PORTC
_PORTH           		EQU	 PORTC
; C:\PROGRAM FILES (X86)\PBP3\DEVICES\PIC16F684.PBPINC	00139	TRISL   VAR     TRISA
_TRISL           		EQU	 TRISA
; C:\PROGRAM FILES (X86)\PBP3\DEVICES\PIC16F684.PBPINC	00140	TRISH   VAR     TRISC
_TRISH           		EQU	 TRISC
#define _CLCK            	_PORTA??5
#define _RST             	_PORTA??4
#define _BTN             	_PORTA??2
#define _DOT2            	_PORTC??1
#define _DOT1            	_PORTC??2
#define _PIEZO           	_PORTC??0
#define _IRLED           	_PORTC??5
#define _REZERV1         	_PORTA??0
#define _REZERV2         	_PORTA??1
#define _PORTA??5        	 PORTA, 005h
#define _PORTA??4        	 PORTA, 004h
#define _PORTA??2        	 PORTA, 002h
#define _PORTC??1        	 PORTC, 001h
#define _PORTC??2        	 PORTC, 002h
#define _PORTC??0        	 PORTC, 000h
#define _PORTC??5        	 PORTC, 005h
#define _PORTA??0        	 PORTA, 000h
#define _PORTA??1        	 PORTA, 001h
#define _databyte??7     	_databyte, 007h

; Constants.
_protocol        		EQU	000E8h
_mtheader        		EQU	00960h
_mtbit0          		EQU	00258h
_mtbit1          		EQU	004B0h
_mtspace         		EQU	00258h
	INCLUDE	"UMAB_V0_4A_RELEASE.MAC"
	INCLUDE	"C:\PROGRAM FILES (X86)\PBP3\PBPPIC14.LIB"


; C:\PROGRAM FILES (X86)\PBP3\DEVICES\PIC16F684.PBPINC	00036	#HEADER
; C:\PROGRAM FILES (X86)\PBP3\DEVICES\PIC16F684.PBPINC	00060	#CONFIG
; C:\PROGRAM FILES (X86)\PBP3\DEVICES\PIC16F684.PBPINC	00129	BANK0   $0020, $007F
; C:\PROGRAM FILES (X86)\PBP3\DEVICES\PIC16F684.PBPINC	00130	BANK1   $00A0, $00BF
; C:\PROGRAM FILES (X86)\PBP3\DEVICES\PIC16F684.PBPINC	00132	EEPROM  $2100, $21FF
; C:\PROGRAM FILES (X86)\PBP3\DEVICES\PIC16F684.PBPINC	00134	    #ERROR "-n option (PBPL) is not supported for this device."
; C:\PROGRAM FILES (X86)\PBP3\DEVICES\PIC16F684.PBPINC	00135	#ENDIF
; C:\PROGRAM FILES (X86)\PBP3\DEVICES\PIC16F684.PBPINC	00136	LIBRARY "PBPPIC14"

; C:\PROGRAM FILES (X86)\PBP3\DEVICES\PIC16F684.PBPINC	00141	include "PBPPIC14.RAM"
; C:\PROGRAM FILES (X86)\PBP3\DEVICES\PIC16F684.PBPINC	00145	#HEADER
; C:\PROGRAM FILES (X86)\PBP3\DEVICES\PIC16F684.PBPINC	00149	DEFINE	CCP1_REG PORTC
; C:\PROGRAM FILES (X86)\PBP3\DEVICES\PIC16F684.PBPINC	00150	DEFINE	CCP1_BIT 5
; C:\USERS\DMITR\DOCUMENTS\GITHUB\UMAB\UMAB_V0_4A_RELEASE.PBP	00008	DEFINE OSC 8
; C:\USERS\DMITR\DOCUMENTS\GITHUB\UMAB\UMAB_V0_4A_RELEASE.PBP	00013	protocol    CON 232           '232=MT Core
; C:\USERS\DMITR\DOCUMENTS\GITHUB\UMAB\UMAB_V0_4A_RELEASE.PBP	00015	mtheader    CON 2400
; C:\USERS\DMITR\DOCUMENTS\GITHUB\UMAB\UMAB_V0_4A_RELEASE.PBP	00016	mtbit0      CON 600
; C:\USERS\DMITR\DOCUMENTS\GITHUB\UMAB\UMAB_V0_4A_RELEASE.PBP	00017	mtbit1      CON 1200
; C:\USERS\DMITR\DOCUMENTS\GITHUB\UMAB\UMAB_V0_4A_RELEASE.PBP	00018	mtspace     CON 600
; C:\USERS\DMITR\DOCUMENTS\GITHUB\UMAB\UMAB_V0_4A_RELEASE.PBP	00067	Symbol CLCK 	    	= PORTA.5		'Счётчик +1
; C:\USERS\DMITR\DOCUMENTS\GITHUB\UMAB\UMAB_V0_4A_RELEASE.PBP	00068	Symbol RST       	= PORTA.4		'Сброс дисплеев
; C:\USERS\DMITR\DOCUMENTS\GITHUB\UMAB\UMAB_V0_4A_RELEASE.PBP	00069	Symbol BTN       	= PORTA.2		'Кнопка
; C:\USERS\DMITR\DOCUMENTS\GITHUB\UMAB\UMAB_V0_4A_RELEASE.PBP	00070	Symbol DOT2         	= PORTC.1           	'Точка на правом индикаторе
; C:\USERS\DMITR\DOCUMENTS\GITHUB\UMAB\UMAB_V0_4A_RELEASE.PBP	00071	SYMBOL DOT1         	= PORTC.2           	'Точка на левом индикаторе
; C:\USERS\DMITR\DOCUMENTS\GITHUB\UMAB\UMAB_V0_4A_RELEASE.PBP	00072	Symbol PIEZO 		= PORTC.0         	'Зуммер
; C:\USERS\DMITR\DOCUMENTS\GITHUB\UMAB\UMAB_V0_4A_RELEASE.PBP	00073	Symbol IRLED 		= PORTC.5         	'ИК-светодиод
; C:\USERS\DMITR\DOCUMENTS\GITHUB\UMAB\UMAB_V0_4A_RELEASE.PBP	00079	Symbol REZERV1      	= PORTA.0           	'Зарезервировано
; C:\USERS\DMITR\DOCUMENTS\GITHUB\UMAB\UMAB_V0_4A_RELEASE.PBP	00080	Symbol REZERV2      	= PORTA.1           	'Зарезервировано

; C:\USERS\DMITR\DOCUMENTS\GITHUB\UMAB\UMAB_V0_4A_RELEASE.PBP	00088	OSCCON = %01111000
	MOVE?CB	078h, OSCCON

; C:\USERS\DMITR\DOCUMENTS\GITHUB\UMAB\UMAB_V0_4A_RELEASE.PBP	00089	CMCON0 = 7				'turn off comparators
	MOVE?CB	007h, CMCON0

; C:\USERS\DMITR\DOCUMENTS\GITHUB\UMAB\UMAB_V0_4A_RELEASE.PBP	00090	ANSEL = 0
	MOVE?CB	000h, ANSEL

; C:\USERS\DMITR\DOCUMENTS\GITHUB\UMAB\UMAB_V0_4A_RELEASE.PBP	00092	PR2 = 35				'PWM Period (40K=49, 56K=35) (35 to 55)
	MOVE?CB	023h, PR2

; C:\USERS\DMITR\DOCUMENTS\GITHUB\UMAB\UMAB_V0_4A_RELEASE.PBP	00093	CCPR1L = 15				'PWM Duty Cycle (1 to 15)
	MOVE?CB	00Fh, CCPR1L

; C:\USERS\DMITR\DOCUMENTS\GITHUB\UMAB\UMAB_V0_4A_RELEASE.PBP	00094	T2CON = 4				'Timer2 = ON; Prescale = 1:1
	MOVE?CB	004h, T2CON

; C:\USERS\DMITR\DOCUMENTS\GITHUB\UMAB\UMAB_V0_4A_RELEASE.PBP	00095	CCP1CON = 0				'PWM module off
	MOVE?CB	000h, CCP1CON

; C:\USERS\DMITR\DOCUMENTS\GITHUB\UMAB\UMAB_V0_4A_RELEASE.PBP	00096	OPTION_REG = %000111			'Turn PortA weak pull-ups
	MOVE?CB	007h, OPTION_REG

; C:\USERS\DMITR\DOCUMENTS\GITHUB\UMAB\UMAB_V0_4A_RELEASE.PBP	00098	TRISA = %000111    			'set PortA directions
	MOVE?CB	007h, TRISA

; C:\USERS\DMITR\DOCUMENTS\GITHUB\UMAB\UMAB_V0_4A_RELEASE.PBP	00099	WPUA =  %000111				'enable weak pull-ups PortA
	MOVE?CB	007h, WPUA

; C:\USERS\DMITR\DOCUMENTS\GITHUB\UMAB\UMAB_V0_4A_RELEASE.PBP	00100	IOCA =  %000000				'disable PORTA.0 Int On Change
	MOVE?CB	000h, IOCA

; C:\USERS\DMITR\DOCUMENTS\GITHUB\UMAB\UMAB_V0_4A_RELEASE.PBP	00102	input PORTA.2
	INPUT?T	_PORTA??2

; C:\USERS\DMITR\DOCUMENTS\GITHUB\UMAB\UMAB_V0_4A_RELEASE.PBP	00104	TRISC = %00000				'set PortC directions
	MOVE?CB	000h, TRISC

; C:\USERS\DMITR\DOCUMENTS\GITHUB\UMAB\UMAB_V0_4A_RELEASE.PBP	00106	PORTA = %000000				'обнуление значений PortA
	MOVE?CB	000h, PORTA

; C:\USERS\DMITR\DOCUMENTS\GITHUB\UMAB\UMAB_V0_4A_RELEASE.PBP	00107	PORTC = %000000    			'обнуление значений PortC
	MOVE?CB	000h, PORTC

; C:\USERS\DMITR\DOCUMENTS\GITHUB\UMAB\UMAB_V0_4A_RELEASE.PBP	00109	flag = 0
	MOVE?CB	000h, _flag

; C:\USERS\DMITR\DOCUMENTS\GITHUB\UMAB\UMAB_V0_4A_RELEASE.PBP	00116	start:

	LABEL?L	_start	

; C:\USERS\DMITR\DOCUMENTS\GITHUB\UMAB\UMAB_V0_4A_RELEASE.PBP	00118	gosub read_settings
	GOSUB?L	_read_settings

; C:\USERS\DMITR\DOCUMENTS\GITHUB\UMAB\UMAB_V0_4A_RELEASE.PBP	00119	gosub clear_screen
	GOSUB?L	_clear_screen

; C:\USERS\DMITR\DOCUMENTS\GITHUB\UMAB\UMAB_V0_4A_RELEASE.PBP	00126	if btn = 0 then
	CMPNE?TCL	_BTN, 000h, L00003

; C:\USERS\DMITR\DOCUMENTS\GITHUB\UMAB\UMAB_V0_4A_RELEASE.PBP	00127		for temp = 1 to 100
	MOVE?CB	001h, _TEMP
	LABEL?L	L00005	
	CMPGT?BCL	_TEMP, 064h, L00006

; C:\USERS\DMITR\DOCUMENTS\GITHUB\UMAB\UMAB_V0_4A_RELEASE.PBP	00128			if btn = 1 then main
	CMPEQ?TCL	_BTN, 001h, _main

; C:\USERS\DMITR\DOCUMENTS\GITHUB\UMAB\UMAB_V0_4A_RELEASE.PBP	00129			pause 10
	PAUSE?C	00Ah

; C:\USERS\DMITR\DOCUMENTS\GITHUB\UMAB\UMAB_V0_4A_RELEASE.PBP	00130	        next temp
	NEXT?BCL	_TEMP, 001h, L00005
	LABEL?L	L00006	

; C:\USERS\DMITR\DOCUMENTS\GITHUB\UMAB\UMAB_V0_4A_RELEASE.PBP	00131	        high PIEZO          
	HIGH?T	_PIEZO

; C:\USERS\DMITR\DOCUMENTS\GITHUB\UMAB\UMAB_V0_4A_RELEASE.PBP	00132	        PAUSE 1000          
	PAUSE?C	003E8h

; C:\USERS\DMITR\DOCUMENTS\GITHUB\UMAB\UMAB_V0_4A_RELEASE.PBP	00133	        LOW PIEZO
	LOW?T	_PIEZO

; C:\USERS\DMITR\DOCUMENTS\GITHUB\UMAB\UMAB_V0_4A_RELEASE.PBP	00134	        goto settings     
	GOTO?L	_settings

; C:\USERS\DMITR\DOCUMENTS\GITHUB\UMAB\UMAB_V0_4A_RELEASE.PBP	00135	else 
	GOTO?L	L00004
	LABEL?L	L00003	

; C:\USERS\DMITR\DOCUMENTS\GITHUB\UMAB\UMAB_V0_4A_RELEASE.PBP	00136	        goto main
	GOTO?L	_main

; C:\USERS\DMITR\DOCUMENTS\GITHUB\UMAB\UMAB_V0_4A_RELEASE.PBP	00137	endif        
	LABEL?L	L00004	

; C:\USERS\DMITR\DOCUMENTS\GITHUB\UMAB\UMAB_V0_4A_RELEASE.PBP	00139	main:    

	LABEL?L	_main	

; C:\USERS\DMITR\DOCUMENTS\GITHUB\UMAB\UMAB_V0_4A_RELEASE.PBP	00146	setup = 0
	MOVE?CB	000h, _setup

; C:\USERS\DMITR\DOCUMENTS\GITHUB\UMAB\UMAB_V0_4A_RELEASE.PBP	00147	amount = mode
	MOVE?BB	_MODE, _AMOUNT

; C:\USERS\DMITR\DOCUMENTS\GITHUB\UMAB\UMAB_V0_4A_RELEASE.PBP	00148	gosub print_current
	GOSUB?L	_print_current

; C:\USERS\DMITR\DOCUMENTS\GITHUB\UMAB\UMAB_V0_4A_RELEASE.PBP	00149	high PIEZO          
	HIGH?T	_PIEZO

; C:\USERS\DMITR\DOCUMENTS\GITHUB\UMAB\UMAB_V0_4A_RELEASE.PBP	00150	PAUSE 200          
	PAUSE?C	0C8h

; C:\USERS\DMITR\DOCUMENTS\GITHUB\UMAB\UMAB_V0_4A_RELEASE.PBP	00151	LOW PIEZO
	LOW?T	_PIEZO

; C:\USERS\DMITR\DOCUMENTS\GITHUB\UMAB\UMAB_V0_4A_RELEASE.PBP	00152	pause 800
	PAUSE?C	00320h

; C:\USERS\DMITR\DOCUMENTS\GITHUB\UMAB\UMAB_V0_4A_RELEASE.PBP	00153	gosub clear_screen
	GOSUB?L	_clear_screen

; C:\USERS\DMITR\DOCUMENTS\GITHUB\UMAB\UMAB_V0_4A_RELEASE.PBP	00161	select case mode

; C:\USERS\DMITR\DOCUMENTS\GITHUB\UMAB\UMAB_V0_4A_RELEASE.PBP	00162		case 1
	CMPNE?BCL	_MODE, 001h, L00009

; C:\USERS\DMITR\DOCUMENTS\GITHUB\UMAB\UMAB_V0_4A_RELEASE.PBP	00163			message_ID = 0                          	'Идентификатор медика
	MOVE?CB	000h, _message_ID

; C:\USERS\DMITR\DOCUMENTS\GITHUB\UMAB\UMAB_V0_4A_RELEASE.PBP	00164			lookup cap_med,[1,5,10,25,50],message		'Устанавливаем количество здоровья, посылаемое за раз
	LOOKUP?BCLB	_CAP_MED, 005h, L00001, _message
	LURET?C	001h
	LURET?C	005h
	LURET?C	00Ah
	LURET?C	019h
	LURET?C	032h

	LABEL?L	L00001	

; C:\USERS\DMITR\DOCUMENTS\GITHUB\UMAB\UMAB_V0_4A_RELEASE.PBP	00165			amount = amount_med				'Устаналиваем ёмкость сумки
	MOVE?BB	_AMOUNT_MED, _AMOUNT

; C:\USERS\DMITR\DOCUMENTS\GITHUB\UMAB\UMAB_V0_4A_RELEASE.PBP	00166			rate = rate_med * 100
	MUL?BCB	_RATE_MED, 064h, _RATE

; C:\USERS\DMITR\DOCUMENTS\GITHUB\UMAB\UMAB_V0_4A_RELEASE.PBP	00167			goto universal_box
	GOTO?L	_universal_box

; C:\USERS\DMITR\DOCUMENTS\GITHUB\UMAB\UMAB_V0_4A_RELEASE.PBP	00168	        case 2
	GOTO?L	L00008
	LABEL?L	L00009	
	CMPNE?BCL	_MODE, 002h, L00010

; C:\USERS\DMITR\DOCUMENTS\GITHUB\UMAB\UMAB_V0_4A_RELEASE.PBP	00169			message_ID = 1                          	'Идентификатор ящика с патронами
	MOVE?CB	001h, _message_ID

; C:\USERS\DMITR\DOCUMENTS\GITHUB\UMAB\UMAB_V0_4A_RELEASE.PBP	00170			message = cap_ammo
	MOVE?BB	_CAP_AMMO, _message

; C:\USERS\DMITR\DOCUMENTS\GITHUB\UMAB\UMAB_V0_4A_RELEASE.PBP	00171			amount = amount_ammo
	MOVE?BB	_AMOUNT_AMMO, _AMOUNT

; C:\USERS\DMITR\DOCUMENTS\GITHUB\UMAB\UMAB_V0_4A_RELEASE.PBP	00172			rate = rate_ammo * 100
	MUL?BCB	_RATE_AMMO, 064h, _RATE

; C:\USERS\DMITR\DOCUMENTS\GITHUB\UMAB\UMAB_V0_4A_RELEASE.PBP	00173			goto universal_box
	GOTO?L	_universal_box

; C:\USERS\DMITR\DOCUMENTS\GITHUB\UMAB\UMAB_V0_4A_RELEASE.PBP	00174	        case 3
	GOTO?L	L00008
	LABEL?L	L00010	
	CMPNE?BCL	_MODE, 003h, L00011

; C:\USERS\DMITR\DOCUMENTS\GITHUB\UMAB\UMAB_V0_4A_RELEASE.PBP	00175			message_ID = 3                          	'Идентификатор пульта
	MOVE?CB	003h, _message_ID

; C:\USERS\DMITR\DOCUMENTS\GITHUB\UMAB\UMAB_V0_4A_RELEASE.PBP	00176			message = $05                           	'Новая игра
	MOVE?CB	005h, _message

; C:\USERS\DMITR\DOCUMENTS\GITHUB\UMAB\UMAB_V0_4A_RELEASE.PBP	00177			amount = amount_aidkit
	MOVE?BB	_AMOUNT_AIDKIT, _AMOUNT

; C:\USERS\DMITR\DOCUMENTS\GITHUB\UMAB\UMAB_V0_4A_RELEASE.PBP	00178			rate = rate_aidkit * 100
	MUL?BCB	_RATE_AIDKIT, 064h, _RATE

; C:\USERS\DMITR\DOCUMENTS\GITHUB\UMAB\UMAB_V0_4A_RELEASE.PBP	00179			goto universal_box
	GOTO?L	_universal_box

; C:\USERS\DMITR\DOCUMENTS\GITHUB\UMAB\UMAB_V0_4A_RELEASE.PBP	00180	        case 4
	GOTO?L	L00008
	LABEL?L	L00011	
	CMPNE?BCL	_MODE, 004h, L00012

; C:\USERS\DMITR\DOCUMENTS\GITHUB\UMAB\UMAB_V0_4A_RELEASE.PBP	00181			message_ID = 3                          	'идентификатор пульта
	MOVE?CB	003h, _message_ID

; C:\USERS\DMITR\DOCUMENTS\GITHUB\UMAB\UMAB_V0_4A_RELEASE.PBP	00182			message = $05                           	'Новая игра
	MOVE?CB	005h, _message

; C:\USERS\DMITR\DOCUMENTS\GITHUB\UMAB\UMAB_V0_4A_RELEASE.PBP	00183			rate = rate_aidkit_inf * 100                                                      
	MUL?BCB	_RATE_AIDKIT_INF, 064h, _RATE

; C:\USERS\DMITR\DOCUMENTS\GITHUB\UMAB\UMAB_V0_4A_RELEASE.PBP	00184			goto aidkit_infinite                          
	GOTO?L	_aidkit_infinite

; C:\USERS\DMITR\DOCUMENTS\GITHUB\UMAB\UMAB_V0_4A_RELEASE.PBP	00185	        case else
	GOTO?L	L00008
	LABEL?L	L00012	

; C:\USERS\DMITR\DOCUMENTS\GITHUB\UMAB\UMAB_V0_4A_RELEASE.PBP	00186			goto shutdown
	GOTO?L	_shutdown

; C:\USERS\DMITR\DOCUMENTS\GITHUB\UMAB\UMAB_V0_4A_RELEASE.PBP	00187	end select
	LABEL?L	L00008	

; C:\USERS\DMITR\DOCUMENTS\GITHUB\UMAB\UMAB_V0_4A_RELEASE.PBP	00194	universal_box:

	LABEL?L	_universal_box	

; C:\USERS\DMITR\DOCUMENTS\GITHUB\UMAB\UMAB_V0_4A_RELEASE.PBP	00196	gosub clear_screen
	GOSUB?L	_clear_screen

; C:\USERS\DMITR\DOCUMENTS\GITHUB\UMAB\UMAB_V0_4A_RELEASE.PBP	00197	gosub print_current
	GOSUB?L	_print_current

; C:\USERS\DMITR\DOCUMENTS\GITHUB\UMAB\UMAB_V0_4A_RELEASE.PBP	00199	button_loop:

	LABEL?L	_button_loop	

; C:\USERS\DMITR\DOCUMENTS\GITHUB\UMAB\UMAB_V0_4A_RELEASE.PBP	00201	select case rate

; C:\USERS\DMITR\DOCUMENTS\GITHUB\UMAB\UMAB_V0_4A_RELEASE.PBP	00202		case 0
	CMPNE?BCL	_RATE, 000h, L00015

; C:\USERS\DMITR\DOCUMENTS\GITHUB\UMAB\UMAB_V0_4A_RELEASE.PBP	00203			if (btn = 0) and (flag = 0) then
	CMPEQ?TCB	_BTN, 000h, T1
	CMPEQ?BCB	_flag, 000h, T2
	LAND?BBW	T1, T2, T2
	CMPF?WL	T2, L00016

; C:\USERS\DMITR\DOCUMENTS\GITHUB\UMAB\UMAB_V0_4A_RELEASE.PBP	00204				if amount > 0 then
	CMPLE?BCL	_AMOUNT, 000h, L00018

; C:\USERS\DMITR\DOCUMENTS\GITHUB\UMAB\UMAB_V0_4A_RELEASE.PBP	00205					flag = 1
	MOVE?CB	001h, _flag

; C:\USERS\DMITR\DOCUMENTS\GITHUB\UMAB\UMAB_V0_4A_RELEASE.PBP	00206					amount = amount - 1
	SUB?BCB	_AMOUNT, 001h, _AMOUNT

; C:\USERS\DMITR\DOCUMENTS\GITHUB\UMAB\UMAB_V0_4A_RELEASE.PBP	00207					gosub send_message
	GOSUB?L	_send_message

; C:\USERS\DMITR\DOCUMENTS\GITHUB\UMAB\UMAB_V0_4A_RELEASE.PBP	00208				else
	GOTO?L	L00019
	LABEL?L	L00018	

; C:\USERS\DMITR\DOCUMENTS\GITHUB\UMAB\UMAB_V0_4A_RELEASE.PBP	00209					goto shutdown
	GOTO?L	_shutdown

; C:\USERS\DMITR\DOCUMENTS\GITHUB\UMAB\UMAB_V0_4A_RELEASE.PBP	00210				endif
	LABEL?L	L00019	

; C:\USERS\DMITR\DOCUMENTS\GITHUB\UMAB\UMAB_V0_4A_RELEASE.PBP	00211			endif
	LABEL?L	L00016	

; C:\USERS\DMITR\DOCUMENTS\GITHUB\UMAB\UMAB_V0_4A_RELEASE.PBP	00212			if (btn = 1) and (flag = 1) then
	CMPEQ?TCB	_BTN, 001h, T1
	CMPEQ?BCB	_flag, 001h, T2
	LAND?BBW	T1, T2, T2
	CMPF?WL	T2, L00020

; C:\USERS\DMITR\DOCUMENTS\GITHUB\UMAB\UMAB_V0_4A_RELEASE.PBP	00213				flag = 0
	MOVE?CB	000h, _flag

; C:\USERS\DMITR\DOCUMENTS\GITHUB\UMAB\UMAB_V0_4A_RELEASE.PBP	00214				goto universal_box
	GOTO?L	_universal_box

; C:\USERS\DMITR\DOCUMENTS\GITHUB\UMAB\UMAB_V0_4A_RELEASE.PBP	00215			endif		
	LABEL?L	L00020	

; C:\USERS\DMITR\DOCUMENTS\GITHUB\UMAB\UMAB_V0_4A_RELEASE.PBP	00216			nap 3
	NAP?C	003h

; C:\USERS\DMITR\DOCUMENTS\GITHUB\UMAB\UMAB_V0_4A_RELEASE.PBP	00217			goto button_loop
	GOTO?L	_button_loop

; C:\USERS\DMITR\DOCUMENTS\GITHUB\UMAB\UMAB_V0_4A_RELEASE.PBP	00218	    	case else
	GOTO?L	L00014
	LABEL?L	L00015	

; C:\USERS\DMITR\DOCUMENTS\GITHUB\UMAB\UMAB_V0_4A_RELEASE.PBP	00219			if btn = 0 then
	CMPNE?TCL	_BTN, 000h, L00022

; C:\USERS\DMITR\DOCUMENTS\GITHUB\UMAB\UMAB_V0_4A_RELEASE.PBP	00220				if amount > 0 then
	CMPLE?BCL	_AMOUNT, 000h, L00024

; C:\USERS\DMITR\DOCUMENTS\GITHUB\UMAB\UMAB_V0_4A_RELEASE.PBP	00221					for temp = 1 to rate
	MOVE?CB	001h, _TEMP
	LABEL?L	L00026	
	CMPGT?BBL	_TEMP, _RATE, L00027

; C:\USERS\DMITR\DOCUMENTS\GITHUB\UMAB\UMAB_V0_4A_RELEASE.PBP	00222						if btn = 1 then button_loop
	CMPEQ?TCL	_BTN, 001h, _button_loop

; C:\USERS\DMITR\DOCUMENTS\GITHUB\UMAB\UMAB_V0_4A_RELEASE.PBP	00223						pause 10
	PAUSE?C	00Ah

; C:\USERS\DMITR\DOCUMENTS\GITHUB\UMAB\UMAB_V0_4A_RELEASE.PBP	00224					next temp
	NEXT?BCL	_TEMP, 001h, L00026
	LABEL?L	L00027	

; C:\USERS\DMITR\DOCUMENTS\GITHUB\UMAB\UMAB_V0_4A_RELEASE.PBP	00225					amount = amount - 1
	SUB?BCB	_AMOUNT, 001h, _AMOUNT

; C:\USERS\DMITR\DOCUMENTS\GITHUB\UMAB\UMAB_V0_4A_RELEASE.PBP	00226					gosub send_message
	GOSUB?L	_send_message

; C:\USERS\DMITR\DOCUMENTS\GITHUB\UMAB\UMAB_V0_4A_RELEASE.PBP	00227					goto universal_box
	GOTO?L	_universal_box

; C:\USERS\DMITR\DOCUMENTS\GITHUB\UMAB\UMAB_V0_4A_RELEASE.PBP	00228				else 
	GOTO?L	L00025
	LABEL?L	L00024	

; C:\USERS\DMITR\DOCUMENTS\GITHUB\UMAB\UMAB_V0_4A_RELEASE.PBP	00229					goto shutdown
	GOTO?L	_shutdown

; C:\USERS\DMITR\DOCUMENTS\GITHUB\UMAB\UMAB_V0_4A_RELEASE.PBP	00230				endif
	LABEL?L	L00025	

; C:\USERS\DMITR\DOCUMENTS\GITHUB\UMAB\UMAB_V0_4A_RELEASE.PBP	00231			endif
	LABEL?L	L00022	

; C:\USERS\DMITR\DOCUMENTS\GITHUB\UMAB\UMAB_V0_4A_RELEASE.PBP	00232			nap 3
	NAP?C	003h

; C:\USERS\DMITR\DOCUMENTS\GITHUB\UMAB\UMAB_V0_4A_RELEASE.PBP	00233			goto button_loop    	
	GOTO?L	_button_loop

; C:\USERS\DMITR\DOCUMENTS\GITHUB\UMAB\UMAB_V0_4A_RELEASE.PBP	00234	end select
	LABEL?L	L00014	

; C:\USERS\DMITR\DOCUMENTS\GITHUB\UMAB\UMAB_V0_4A_RELEASE.PBP	00240	aidkit_infinite:

	LABEL?L	_aidkit_infinite	

; C:\USERS\DMITR\DOCUMENTS\GITHUB\UMAB\UMAB_V0_4A_RELEASE.PBP	00242	select case rate

; C:\USERS\DMITR\DOCUMENTS\GITHUB\UMAB\UMAB_V0_4A_RELEASE.PBP	00243		case 0
	CMPNE?BCL	_RATE, 000h, L00030

; C:\USERS\DMITR\DOCUMENTS\GITHUB\UMAB\UMAB_V0_4A_RELEASE.PBP	00244			if (btn = 0) and (flag = 0) then
	CMPEQ?TCB	_BTN, 000h, T1
	CMPEQ?BCB	_flag, 000h, T2
	LAND?BBW	T1, T2, T2
	CMPF?WL	T2, L00031

; C:\USERS\DMITR\DOCUMENTS\GITHUB\UMAB\UMAB_V0_4A_RELEASE.PBP	00245				flag = 1
	MOVE?CB	001h, _flag

; C:\USERS\DMITR\DOCUMENTS\GITHUB\UMAB\UMAB_V0_4A_RELEASE.PBP	00246				gosub send_message
	GOSUB?L	_send_message

; C:\USERS\DMITR\DOCUMENTS\GITHUB\UMAB\UMAB_V0_4A_RELEASE.PBP	00247			endif
	LABEL?L	L00031	

; C:\USERS\DMITR\DOCUMENTS\GITHUB\UMAB\UMAB_V0_4A_RELEASE.PBP	00248			if (btn = 1) and (flag = 1) then
	CMPEQ?TCB	_BTN, 001h, T1
	CMPEQ?BCB	_flag, 001h, T2
	LAND?BBW	T1, T2, T2
	CMPF?WL	T2, L00033

; C:\USERS\DMITR\DOCUMENTS\GITHUB\UMAB\UMAB_V0_4A_RELEASE.PBP	00249				flag = 0
	MOVE?CB	000h, _flag

; C:\USERS\DMITR\DOCUMENTS\GITHUB\UMAB\UMAB_V0_4A_RELEASE.PBP	00250				goto aidkit_infinite
	GOTO?L	_aidkit_infinite

; C:\USERS\DMITR\DOCUMENTS\GITHUB\UMAB\UMAB_V0_4A_RELEASE.PBP	00251			endif
	LABEL?L	L00033	

; C:\USERS\DMITR\DOCUMENTS\GITHUB\UMAB\UMAB_V0_4A_RELEASE.PBP	00252			nap 3
	NAP?C	003h

; C:\USERS\DMITR\DOCUMENTS\GITHUB\UMAB\UMAB_V0_4A_RELEASE.PBP	00253			goto aidkit_infinite
	GOTO?L	_aidkit_infinite

; C:\USERS\DMITR\DOCUMENTS\GITHUB\UMAB\UMAB_V0_4A_RELEASE.PBP	00254	    	case else
	GOTO?L	L00029
	LABEL?L	L00030	

; C:\USERS\DMITR\DOCUMENTS\GITHUB\UMAB\UMAB_V0_4A_RELEASE.PBP	00255			IF btn = 0 THEN                         
	CMPNE?TCL	_BTN, 000h, L00035

; C:\USERS\DMITR\DOCUMENTS\GITHUB\UMAB\UMAB_V0_4A_RELEASE.PBP	00256				for temp = 1 to rate
	MOVE?CB	001h, _TEMP
	LABEL?L	L00037	
	CMPGT?BBL	_TEMP, _RATE, L00038

; C:\USERS\DMITR\DOCUMENTS\GITHUB\UMAB\UMAB_V0_4A_RELEASE.PBP	00257					if btn = 1 then aidkit_infinite
	CMPEQ?TCL	_BTN, 001h, _aidkit_infinite

; C:\USERS\DMITR\DOCUMENTS\GITHUB\UMAB\UMAB_V0_4A_RELEASE.PBP	00258					pause 10
	PAUSE?C	00Ah

; C:\USERS\DMITR\DOCUMENTS\GITHUB\UMAB\UMAB_V0_4A_RELEASE.PBP	00259				next temp							
	NEXT?BCL	_TEMP, 001h, L00037
	LABEL?L	L00038	

; C:\USERS\DMITR\DOCUMENTS\GITHUB\UMAB\UMAB_V0_4A_RELEASE.PBP	00260				gosub send_message
	GOSUB?L	_send_message

; C:\USERS\DMITR\DOCUMENTS\GITHUB\UMAB\UMAB_V0_4A_RELEASE.PBP	00261				goto aidkit_infinite 
	GOTO?L	_aidkit_infinite

; C:\USERS\DMITR\DOCUMENTS\GITHUB\UMAB\UMAB_V0_4A_RELEASE.PBP	00262			ENDIF
	LABEL?L	L00035	

; C:\USERS\DMITR\DOCUMENTS\GITHUB\UMAB\UMAB_V0_4A_RELEASE.PBP	00263			nap 3
	NAP?C	003h

; C:\USERS\DMITR\DOCUMENTS\GITHUB\UMAB\UMAB_V0_4A_RELEASE.PBP	00264			goto aidkit_infinite    	
	GOTO?L	_aidkit_infinite

; C:\USERS\DMITR\DOCUMENTS\GITHUB\UMAB\UMAB_V0_4A_RELEASE.PBP	00265	end select 
	LABEL?L	L00029	

; C:\USERS\DMITR\DOCUMENTS\GITHUB\UMAB\UMAB_V0_4A_RELEASE.PBP	00271	settings:						'Предварительные настройки

	LABEL?L	_settings	

; C:\USERS\DMITR\DOCUMENTS\GITHUB\UMAB\UMAB_V0_4A_RELEASE.PBP	00273	high dot1						'Зажигаем правую точку для индикации режима настройки
	HIGH?T	_DOT1

; C:\USERS\DMITR\DOCUMENTS\GITHUB\UMAB\UMAB_V0_4A_RELEASE.PBP	00274	setup = 1
	MOVE?CB	001h, _setup

; C:\USERS\DMITR\DOCUMENTS\GITHUB\UMAB\UMAB_V0_4A_RELEASE.PBP	00275	addr = 0
	MOVE?CB	000h, _addr

; C:\USERS\DMITR\DOCUMENTS\GITHUB\UMAB\UMAB_V0_4A_RELEASE.PBP	00276	amount = mode
	MOVE?BB	_MODE, _AMOUNT

; C:\USERS\DMITR\DOCUMENTS\GITHUB\UMAB\UMAB_V0_4A_RELEASE.PBP	00277	min_value = 1
	MOVE?CB	001h, _min_value

; C:\USERS\DMITR\DOCUMENTS\GITHUB\UMAB\UMAB_V0_4A_RELEASE.PBP	00278	max_value = 4
	MOVE?CB	004h, _MAX_value

; C:\USERS\DMITR\DOCUMENTS\GITHUB\UMAB\UMAB_V0_4A_RELEASE.PBP	00279	inc = 1
	MOVE?CB	001h, _INC

; C:\USERS\DMITR\DOCUMENTS\GITHUB\UMAB\UMAB_V0_4A_RELEASE.PBP	00280	gosub common_settings
	GOSUB?L	_common_settings

; C:\USERS\DMITR\DOCUMENTS\GITHUB\UMAB\UMAB_V0_4A_RELEASE.PBP	00281	mode = amount
	MOVE?BB	_AMOUNT, _MODE

; C:\USERS\DMITR\DOCUMENTS\GITHUB\UMAB\UMAB_V0_4A_RELEASE.PBP	00288	pre_setting_amount:

	LABEL?L	_pre_setting_amount	

; C:\USERS\DMITR\DOCUMENTS\GITHUB\UMAB\UMAB_V0_4A_RELEASE.PBP	00290	addr = mode
	MOVE?BB	_MODE, _addr

; C:\USERS\DMITR\DOCUMENTS\GITHUB\UMAB\UMAB_V0_4A_RELEASE.PBP	00291	min_value = 5
	MOVE?CB	005h, _min_value

; C:\USERS\DMITR\DOCUMENTS\GITHUB\UMAB\UMAB_V0_4A_RELEASE.PBP	00292	max_value = 95
	MOVE?CB	05Fh, _MAX_value

; C:\USERS\DMITR\DOCUMENTS\GITHUB\UMAB\UMAB_V0_4A_RELEASE.PBP	00293	inc = 5
	MOVE?CB	005h, _INC

; C:\USERS\DMITR\DOCUMENTS\GITHUB\UMAB\UMAB_V0_4A_RELEASE.PBP	00294	select case mode

; C:\USERS\DMITR\DOCUMENTS\GITHUB\UMAB\UMAB_V0_4A_RELEASE.PBP	00295		case 1                          		'Режим сумки медика
	CMPNE?BCL	_MODE, 001h, L00041

; C:\USERS\DMITR\DOCUMENTS\GITHUB\UMAB\UMAB_V0_4A_RELEASE.PBP	00296			amount = amount_med
	MOVE?BB	_AMOUNT_MED, _AMOUNT

; C:\USERS\DMITR\DOCUMENTS\GITHUB\UMAB\UMAB_V0_4A_RELEASE.PBP	00297		case 2                          		'Режим ящика с патронами
	GOTO?L	L00040
	LABEL?L	L00041	
	CMPNE?BCL	_MODE, 002h, L00042

; C:\USERS\DMITR\DOCUMENTS\GITHUB\UMAB\UMAB_V0_4A_RELEASE.PBP	00298			amount = amount_ammo
	MOVE?BB	_AMOUNT_AMMO, _AMOUNT

; C:\USERS\DMITR\DOCUMENTS\GITHUB\UMAB\UMAB_V0_4A_RELEASE.PBP	00299		case 3                          		'Точка возрождения с количеством
	GOTO?L	L00040
	LABEL?L	L00042	
	CMPNE?BCL	_MODE, 003h, L00043

; C:\USERS\DMITR\DOCUMENTS\GITHUB\UMAB\UMAB_V0_4A_RELEASE.PBP	00300			Amount = amount_aidkit
	MOVE?BB	_AMOUNT_AIDKIT, _AMOUNT

; C:\USERS\DMITR\DOCUMENTS\GITHUB\UMAB\UMAB_V0_4A_RELEASE.PBP	00301		case 4                          		'Точка возрождения бесконечная
	GOTO?L	L00040
	LABEL?L	L00043	
	CMPNE?BCL	_MODE, 004h, L00044

; C:\USERS\DMITR\DOCUMENTS\GITHUB\UMAB\UMAB_V0_4A_RELEASE.PBP	00302			goto pre_setting_rate                          
	GOTO?L	_pre_setting_rate

; C:\USERS\DMITR\DOCUMENTS\GITHUB\UMAB\UMAB_V0_4A_RELEASE.PBP	00303	end select         
	LABEL?L	L00044	
	LABEL?L	L00040	

; C:\USERS\DMITR\DOCUMENTS\GITHUB\UMAB\UMAB_V0_4A_RELEASE.PBP	00304	gosub common_settings
	GOSUB?L	_common_settings

; C:\USERS\DMITR\DOCUMENTS\GITHUB\UMAB\UMAB_V0_4A_RELEASE.PBP	00310	pre_setting_rate:

	LABEL?L	_pre_setting_rate	

; C:\USERS\DMITR\DOCUMENTS\GITHUB\UMAB\UMAB_V0_4A_RELEASE.PBP	00312	addr = mode + 3
	ADD?BCB	_MODE, 003h, _addr

; C:\USERS\DMITR\DOCUMENTS\GITHUB\UMAB\UMAB_V0_4A_RELEASE.PBP	00313	min_value = 0
	MOVE?CB	000h, _min_value

; C:\USERS\DMITR\DOCUMENTS\GITHUB\UMAB\UMAB_V0_4A_RELEASE.PBP	00314	max_value = 5
	MOVE?CB	005h, _MAX_value

; C:\USERS\DMITR\DOCUMENTS\GITHUB\UMAB\UMAB_V0_4A_RELEASE.PBP	00315	inc = 1
	MOVE?CB	001h, _INC

; C:\USERS\DMITR\DOCUMENTS\GITHUB\UMAB\UMAB_V0_4A_RELEASE.PBP	00316	select case mode

; C:\USERS\DMITR\DOCUMENTS\GITHUB\UMAB\UMAB_V0_4A_RELEASE.PBP	00317		case 1                          		'Режим сумки медика
	CMPNE?BCL	_MODE, 001h, L00047

; C:\USERS\DMITR\DOCUMENTS\GITHUB\UMAB\UMAB_V0_4A_RELEASE.PBP	00318			amount = rate_med
	MOVE?BB	_RATE_MED, _AMOUNT

; C:\USERS\DMITR\DOCUMENTS\GITHUB\UMAB\UMAB_V0_4A_RELEASE.PBP	00319		case 2                          		'Режим ящика с патронами
	GOTO?L	L00046
	LABEL?L	L00047	
	CMPNE?BCL	_MODE, 002h, L00048

; C:\USERS\DMITR\DOCUMENTS\GITHUB\UMAB\UMAB_V0_4A_RELEASE.PBP	00320			amount = rate_ammo
	MOVE?BB	_RATE_AMMO, _AMOUNT

; C:\USERS\DMITR\DOCUMENTS\GITHUB\UMAB\UMAB_V0_4A_RELEASE.PBP	00321		case 3                          		'Точка возрождения с количеством
	GOTO?L	L00046
	LABEL?L	L00048	
	CMPNE?BCL	_MODE, 003h, L00049

; C:\USERS\DMITR\DOCUMENTS\GITHUB\UMAB\UMAB_V0_4A_RELEASE.PBP	00322			Amount = rate_aidkit
	MOVE?BB	_RATE_AIDKIT, _AMOUNT

; C:\USERS\DMITR\DOCUMENTS\GITHUB\UMAB\UMAB_V0_4A_RELEASE.PBP	00323		case 4                          		'Точка возрождения бесконечная
	GOTO?L	L00046
	LABEL?L	L00049	
	CMPNE?BCL	_MODE, 004h, L00050

; C:\USERS\DMITR\DOCUMENTS\GITHUB\UMAB\UMAB_V0_4A_RELEASE.PBP	00324			amount = rate_aidkit_inf                          
	MOVE?BB	_RATE_AIDKIT_INF, _AMOUNT

; C:\USERS\DMITR\DOCUMENTS\GITHUB\UMAB\UMAB_V0_4A_RELEASE.PBP	00325	end select
	LABEL?L	L00050	
	LABEL?L	L00046	

; C:\USERS\DMITR\DOCUMENTS\GITHUB\UMAB\UMAB_V0_4A_RELEASE.PBP	00326	gosub common_settings
	GOSUB?L	_common_settings

; C:\USERS\DMITR\DOCUMENTS\GITHUB\UMAB\UMAB_V0_4A_RELEASE.PBP	00333	pre_setting_capacity:

	LABEL?L	_pre_setting_capacity	

; C:\USERS\DMITR\DOCUMENTS\GITHUB\UMAB\UMAB_V0_4A_RELEASE.PBP	00335	addr = mode + 7
	ADD?BCB	_MODE, 007h, _addr

; C:\USERS\DMITR\DOCUMENTS\GITHUB\UMAB\UMAB_V0_4A_RELEASE.PBP	00336	select case mode

; C:\USERS\DMITR\DOCUMENTS\GITHUB\UMAB\UMAB_V0_4A_RELEASE.PBP	00337		case 1                          		'Режим сумки медика
	CMPNE?BCL	_MODE, 001h, L00053

; C:\USERS\DMITR\DOCUMENTS\GITHUB\UMAB\UMAB_V0_4A_RELEASE.PBP	00338			amount = cap_med
	MOVE?BB	_CAP_MED, _AMOUNT

; C:\USERS\DMITR\DOCUMENTS\GITHUB\UMAB\UMAB_V0_4A_RELEASE.PBP	00339			min_value = 0
	MOVE?CB	000h, _min_value

; C:\USERS\DMITR\DOCUMENTS\GITHUB\UMAB\UMAB_V0_4A_RELEASE.PBP	00340			max_value = 4				' 0 = 1; 1 = 5; 2 = 10; 3 = 25; 4 = 50
	MOVE?CB	004h, _MAX_value

; C:\USERS\DMITR\DOCUMENTS\GITHUB\UMAB\UMAB_V0_4A_RELEASE.PBP	00341			inc = 1
	MOVE?CB	001h, _INC

; C:\USERS\DMITR\DOCUMENTS\GITHUB\UMAB\UMAB_V0_4A_RELEASE.PBP	00342		case 2                          		'Режим ящика с патронами
	GOTO?L	L00052
	LABEL?L	L00053	
	CMPNE?BCL	_MODE, 002h, L00054

; C:\USERS\DMITR\DOCUMENTS\GITHUB\UMAB\UMAB_V0_4A_RELEASE.PBP	00343			amount = cap_ammo
	MOVE?BB	_CAP_AMMO, _AMOUNT

; C:\USERS\DMITR\DOCUMENTS\GITHUB\UMAB\UMAB_V0_4A_RELEASE.PBP	00344			min_value = 30
	MOVE?CB	01Eh, _min_value

; C:\USERS\DMITR\DOCUMENTS\GITHUB\UMAB\UMAB_V0_4A_RELEASE.PBP	00345			max_value = 90
	MOVE?CB	05Ah, _MAX_value

; C:\USERS\DMITR\DOCUMENTS\GITHUB\UMAB\UMAB_V0_4A_RELEASE.PBP	00346			inc = 30
	MOVE?CB	01Eh, _INC

; C:\USERS\DMITR\DOCUMENTS\GITHUB\UMAB\UMAB_V0_4A_RELEASE.PBP	00347		case 3,4                          		'Точка возрождения
	GOTO?L	L00052
	LABEL?L	L00054	
	CMPEQ?BCL	_MODE, 004h, L00055
	CMPNE?BCL	_MODE, 003h, L00056

	LABEL?L	L00055	

; C:\USERS\DMITR\DOCUMENTS\GITHUB\UMAB\UMAB_V0_4A_RELEASE.PBP	00348			goto end_of_settings
	GOTO?L	_end_of_settings

; C:\USERS\DMITR\DOCUMENTS\GITHUB\UMAB\UMAB_V0_4A_RELEASE.PBP	00349	end select
	LABEL?L	L00056	
	LABEL?L	L00052	

; C:\USERS\DMITR\DOCUMENTS\GITHUB\UMAB\UMAB_V0_4A_RELEASE.PBP	00350	gosub common_settings
	GOSUB?L	_common_settings

; C:\USERS\DMITR\DOCUMENTS\GITHUB\UMAB\UMAB_V0_4A_RELEASE.PBP	00356	end_of_settings:

	LABEL?L	_end_of_settings	

; C:\USERS\DMITR\DOCUMENTS\GITHUB\UMAB\UMAB_V0_4A_RELEASE.PBP	00358	gosub clear_screen
	GOSUB?L	_clear_screen

; C:\USERS\DMITR\DOCUMENTS\GITHUB\UMAB\UMAB_V0_4A_RELEASE.PBP	00359	high dot2
	HIGH?T	_DOT2

; C:\USERS\DMITR\DOCUMENTS\GITHUB\UMAB\UMAB_V0_4A_RELEASE.PBP	00360	goto shutdown 
	GOTO?L	_shutdown

; C:\USERS\DMITR\DOCUMENTS\GITHUB\UMAB\UMAB_V0_4A_RELEASE.PBP	00366	common_settings:

	LABEL?L	_common_settings	

; C:\USERS\DMITR\DOCUMENTS\GITHUB\UMAB\UMAB_V0_4A_RELEASE.PBP	00374	gosub clear_screen
	GOSUB?L	_clear_screen

; C:\USERS\DMITR\DOCUMENTS\GITHUB\UMAB\UMAB_V0_4A_RELEASE.PBP	00375	gosub print_current
	GOSUB?L	_print_current

; C:\USERS\DMITR\DOCUMENTS\GITHUB\UMAB\UMAB_V0_4A_RELEASE.PBP	00376	pause 200
	PAUSE?C	0C8h

; C:\USERS\DMITR\DOCUMENTS\GITHUB\UMAB\UMAB_V0_4A_RELEASE.PBP	00378	common_settings_loop:

	LABEL?L	_common_settings_loop	

; C:\USERS\DMITR\DOCUMENTS\GITHUB\UMAB\UMAB_V0_4A_RELEASE.PBP	00388	if btn = 0 then
	CMPNE?TCL	_BTN, 000h, L00057

; C:\USERS\DMITR\DOCUMENTS\GITHUB\UMAB\UMAB_V0_4A_RELEASE.PBP	00389		FOR temp = 1 to 100			'
	MOVE?CB	001h, _TEMP
	LABEL?L	L00059	
	CMPGT?BCL	_TEMP, 064h, L00060

; C:\USERS\DMITR\DOCUMENTS\GITHUB\UMAB\UMAB_V0_4A_RELEASE.PBP	00390			IF btn = 1 THEN 
	CMPNE?TCL	_BTN, 001h, L00061

; C:\USERS\DMITR\DOCUMENTS\GITHUB\UMAB\UMAB_V0_4A_RELEASE.PBP	00391				if amount >= max_value then 
	CMPLT?BBL	_AMOUNT, _MAX_value, L00063

; C:\USERS\DMITR\DOCUMENTS\GITHUB\UMAB\UMAB_V0_4A_RELEASE.PBP	00392					amount = min_value
	MOVE?BB	_min_value, _AMOUNT

; C:\USERS\DMITR\DOCUMENTS\GITHUB\UMAB\UMAB_V0_4A_RELEASE.PBP	00393				else 
	GOTO?L	L00064
	LABEL?L	L00063	

; C:\USERS\DMITR\DOCUMENTS\GITHUB\UMAB\UMAB_V0_4A_RELEASE.PBP	00394					amount = amount + inc
	ADD?BBB	_AMOUNT, _INC, _AMOUNT

; C:\USERS\DMITR\DOCUMENTS\GITHUB\UMAB\UMAB_V0_4A_RELEASE.PBP	00395				endif
	LABEL?L	L00064	

; C:\USERS\DMITR\DOCUMENTS\GITHUB\UMAB\UMAB_V0_4A_RELEASE.PBP	00397				goto common_settings
	GOTO?L	_common_settings

; C:\USERS\DMITR\DOCUMENTS\GITHUB\UMAB\UMAB_V0_4A_RELEASE.PBP	00398			endif
	LABEL?L	L00061	

; C:\USERS\DMITR\DOCUMENTS\GITHUB\UMAB\UMAB_V0_4A_RELEASE.PBP	00399			PAUSE 10
	PAUSE?C	00Ah

; C:\USERS\DMITR\DOCUMENTS\GITHUB\UMAB\UMAB_V0_4A_RELEASE.PBP	00400		NEXT temp
	NEXT?BCL	_TEMP, 001h, L00059
	LABEL?L	L00060	

; C:\USERS\DMITR\DOCUMENTS\GITHUB\UMAB\UMAB_V0_4A_RELEASE.PBP	00401		read addr,def_value
	READADDRESS?B	_addr
	READ?B	_def_value

; C:\USERS\DMITR\DOCUMENTS\GITHUB\UMAB\UMAB_V0_4A_RELEASE.PBP	00402		if amount <> def_value then
	CMPEQ?BBL	_AMOUNT, _def_value, L00065

; C:\USERS\DMITR\DOCUMENTS\GITHUB\UMAB\UMAB_V0_4A_RELEASE.PBP	00403			write addr,amount
	WRITEADDRESS?B	_addr
	WRITE?B	_AMOUNT

; C:\USERS\DMITR\DOCUMENTS\GITHUB\UMAB\UMAB_V0_4A_RELEASE.PBP	00404		endif
	LABEL?L	L00065	

; C:\USERS\DMITR\DOCUMENTS\GITHUB\UMAB\UMAB_V0_4A_RELEASE.PBP	00405		high piezo
	HIGH?T	_PIEZO

; C:\USERS\DMITR\DOCUMENTS\GITHUB\UMAB\UMAB_V0_4A_RELEASE.PBP	00406		pause 200
	PAUSE?C	0C8h

; C:\USERS\DMITR\DOCUMENTS\GITHUB\UMAB\UMAB_V0_4A_RELEASE.PBP	00407		low piezo
	LOW?T	_PIEZO

; C:\USERS\DMITR\DOCUMENTS\GITHUB\UMAB\UMAB_V0_4A_RELEASE.PBP	00408		return
	RETURN?	

; C:\USERS\DMITR\DOCUMENTS\GITHUB\UMAB\UMAB_V0_4A_RELEASE.PBP	00409	else
	GOTO?L	L00058
	LABEL?L	L00057	

; C:\USERS\DMITR\DOCUMENTS\GITHUB\UMAB\UMAB_V0_4A_RELEASE.PBP	00410		nap 3
	NAP?C	003h

; C:\USERS\DMITR\DOCUMENTS\GITHUB\UMAB\UMAB_V0_4A_RELEASE.PBP	00411		goto common_settings_loop
	GOTO?L	_common_settings_loop

; C:\USERS\DMITR\DOCUMENTS\GITHUB\UMAB\UMAB_V0_4A_RELEASE.PBP	00412	endif
	LABEL?L	L00058	

; C:\USERS\DMITR\DOCUMENTS\GITHUB\UMAB\UMAB_V0_4A_RELEASE.PBP	00416	read_settings:              		'Чтение настроек из EEPROM

	LABEL?L	_read_settings	

; C:\USERS\DMITR\DOCUMENTS\GITHUB\UMAB\UMAB_V0_4A_RELEASE.PBP	00418	read 0,mode             		'Режим  1 - Сумка медика; 
	READADDRESS?C	000h
	READ?B	_MODE

; C:\USERS\DMITR\DOCUMENTS\GITHUB\UMAB\UMAB_V0_4A_RELEASE.PBP	00422	read 1,amount_med       		'Ёмкость сумки медика (MODE)
	READADDRESS?C	001h
	READ?B	_AMOUNT_MED

; C:\USERS\DMITR\DOCUMENTS\GITHUB\UMAB\UMAB_V0_4A_RELEASE.PBP	00423	read 2,amount_ammo      		'Ёмкость ящика с патронами (MODE)
	READADDRESS?C	002h
	READ?B	_AMOUNT_AMMO

; C:\USERS\DMITR\DOCUMENTS\GITHUB\UMAB\UMAB_V0_4A_RELEASE.PBP	00424	read 3,AMOUNT_AIDKIT    		'Количество возрождений (MODE)
	READADDRESS?C	003h
	READ?B	_AMOUNT_AIDKIT

; C:\USERS\DMITR\DOCUMENTS\GITHUB\UMAB\UMAB_V0_4A_RELEASE.PBP	00425	read 4,rate_med         		'Длительность нажатия кнопки для сумки медика (MODE+3)
	READADDRESS?C	004h
	READ?B	_RATE_MED

; C:\USERS\DMITR\DOCUMENTS\GITHUB\UMAB\UMAB_V0_4A_RELEASE.PBP	00426	read 5,rate_ammo        		'Длительность нажатия кнопки для ящика с патронами (MODE+3)
	READADDRESS?C	005h
	READ?B	_RATE_AMMO

; C:\USERS\DMITR\DOCUMENTS\GITHUB\UMAB\UMAB_V0_4A_RELEASE.PBP	00427	read 6,rate_aidkit      		'Длительность нажатия кнопки для точки возрождения с количеством срабатываний (MODE+3)
	READADDRESS?C	006h
	READ?B	_RATE_AIDKIT

; C:\USERS\DMITR\DOCUMENTS\GITHUB\UMAB\UMAB_V0_4A_RELEASE.PBP	00428	read 7,rate_aidkit_inf  		'Длительность нажатия кнопки для точки возрождения бесконечной (MODE+3)
	READADDRESS?C	007h
	READ?B	_RATE_AIDKIT_INF

; C:\USERS\DMITR\DOCUMENTS\GITHUB\UMAB\UMAB_V0_4A_RELEASE.PBP	00429	read 8,cap_med				'Количество единиц, выдаваемых сумкой медика за раз (mode+7)
	READADDRESS?C	008h
	READ?B	_CAP_MED

; C:\USERS\DMITR\DOCUMENTS\GITHUB\UMAB\UMAB_V0_4A_RELEASE.PBP	00430	read 9,cap_ammo				'Количество единиц, выдаваемых ящиком патронов за раз (mode+7)
	READADDRESS?C	009h
	READ?B	_CAP_AMMO

; C:\USERS\DMITR\DOCUMENTS\GITHUB\UMAB\UMAB_V0_4A_RELEASE.PBP	00431	return        
	RETURN?	

; C:\USERS\DMITR\DOCUMENTS\GITHUB\UMAB\UMAB_V0_4A_RELEASE.PBP	00435	clear_screen:   			'Сброс индикаторов

	LABEL?L	_clear_screen	

; C:\USERS\DMITR\DOCUMENTS\GITHUB\UMAB\UMAB_V0_4A_RELEASE.PBP	00437	HIGH RST            
	HIGH?T	_RST

; C:\USERS\DMITR\DOCUMENTS\GITHUB\UMAB\UMAB_V0_4A_RELEASE.PBP	00438	LOW RST
	LOW?T	_RST

; C:\USERS\DMITR\DOCUMENTS\GITHUB\UMAB\UMAB_V0_4A_RELEASE.PBP	00439	return
	RETURN?	

; C:\USERS\DMITR\DOCUMENTS\GITHUB\UMAB\UMAB_V0_4A_RELEASE.PBP	00443	print_current:  			'Установка на индикаторах текущего значения переменной AMOUNT

	LABEL?L	_print_current	

; C:\USERS\DMITR\DOCUMENTS\GITHUB\UMAB\UMAB_V0_4A_RELEASE.PBP	00445	temp = 0
	MOVE?CB	000h, _TEMP

; C:\USERS\DMITR\DOCUMENTS\GITHUB\UMAB\UMAB_V0_4A_RELEASE.PBP	00446	if (setup = 1) and (addr = 8) then
	CMPEQ?BCB	_setup, 001h, T1
	CMPEQ?BCB	_addr, 008h, T2
	LAND?BBW	T1, T2, T2
	CMPF?WL	T2, L00067

; C:\USERS\DMITR\DOCUMENTS\GITHUB\UMAB\UMAB_V0_4A_RELEASE.PBP	00447		lookup amount,[1,5,10,25,50],temp_amount
	LOOKUP?BCLB	_AMOUNT, 005h, L00002, _temp_amount
	LURET?C	001h
	LURET?C	005h
	LURET?C	00Ah
	LURET?C	019h
	LURET?C	032h

	LABEL?L	L00002	

; C:\USERS\DMITR\DOCUMENTS\GITHUB\UMAB\UMAB_V0_4A_RELEASE.PBP	00448		temp2 = temp_amount
	MOVE?BB	_temp_amount, _TEMP2

; C:\USERS\DMITR\DOCUMENTS\GITHUB\UMAB\UMAB_V0_4A_RELEASE.PBP	00449	else
	GOTO?L	L00068
	LABEL?L	L00067	

; C:\USERS\DMITR\DOCUMENTS\GITHUB\UMAB\UMAB_V0_4A_RELEASE.PBP	00450		temp2 = amount
	MOVE?BB	_AMOUNT, _TEMP2

; C:\USERS\DMITR\DOCUMENTS\GITHUB\UMAB\UMAB_V0_4A_RELEASE.PBP	00451	endif
	LABEL?L	L00068	

; C:\USERS\DMITR\DOCUMENTS\GITHUB\UMAB\UMAB_V0_4A_RELEASE.PBP	00452	FOR TEMP = 1 to temp2
	MOVE?CB	001h, _TEMP
	LABEL?L	L00069	
	CMPGT?BBL	_TEMP, _TEMP2, L00070

; C:\USERS\DMITR\DOCUMENTS\GITHUB\UMAB\UMAB_V0_4A_RELEASE.PBP	00453		HIGH CLCK
	HIGH?T	_CLCK

; C:\USERS\DMITR\DOCUMENTS\GITHUB\UMAB\UMAB_V0_4A_RELEASE.PBP	00454		LOW CLCK
	LOW?T	_CLCK

; C:\USERS\DMITR\DOCUMENTS\GITHUB\UMAB\UMAB_V0_4A_RELEASE.PBP	00455	NEXT TEMP
	NEXT?BCL	_TEMP, 001h, L00069
	LABEL?L	L00070	

; C:\USERS\DMITR\DOCUMENTS\GITHUB\UMAB\UMAB_V0_4A_RELEASE.PBP	00456	return    
	RETURN?	

; C:\USERS\DMITR\DOCUMENTS\GITHUB\UMAB\UMAB_V0_4A_RELEASE.PBP	00460	shutdown:				'Остановка программы и перевод МК в режим энергосбережения

	LABEL?L	_shutdown	

; C:\USERS\DMITR\DOCUMENTS\GITHUB\UMAB\UMAB_V0_4A_RELEASE.PBP	00462	for temp = 1 to 3
	MOVE?CB	001h, _TEMP
	LABEL?L	L00071	
	CMPGT?BCL	_TEMP, 003h, L00072

; C:\USERS\DMITR\DOCUMENTS\GITHUB\UMAB\UMAB_V0_4A_RELEASE.PBP	00463		high piezo
	HIGH?T	_PIEZO

; C:\USERS\DMITR\DOCUMENTS\GITHUB\UMAB\UMAB_V0_4A_RELEASE.PBP	00464		pause 300
	PAUSE?C	0012Ch

; C:\USERS\DMITR\DOCUMENTS\GITHUB\UMAB\UMAB_V0_4A_RELEASE.PBP	00465		low piezo
	LOW?T	_PIEZO

; C:\USERS\DMITR\DOCUMENTS\GITHUB\UMAB\UMAB_V0_4A_RELEASE.PBP	00466		pause 100
	PAUSE?C	064h

; C:\USERS\DMITR\DOCUMENTS\GITHUB\UMAB\UMAB_V0_4A_RELEASE.PBP	00467	next temp
	NEXT?BCL	_TEMP, 001h, L00071
	LABEL?L	L00072	

; C:\USERS\DMITR\DOCUMENTS\GITHUB\UMAB\UMAB_V0_4A_RELEASE.PBP	00468	stop    
	STOP?	

; C:\USERS\DMITR\DOCUMENTS\GITHUB\UMAB\UMAB_V0_4A_RELEASE.PBP	00475	send_message:					'send 24 bits 

	LABEL?L	_send_message	

; C:\USERS\DMITR\DOCUMENTS\GITHUB\UMAB\UMAB_V0_4A_RELEASE.PBP	00477	high piezo                 
	HIGH?T	_PIEZO

; C:\USERS\DMITR\DOCUMENTS\GITHUB\UMAB\UMAB_V0_4A_RELEASE.PBP	00478	PAUSE 100          
	PAUSE?C	064h

; C:\USERS\DMITR\DOCUMENTS\GITHUB\UMAB\UMAB_V0_4A_RELEASE.PBP	00479	LOW piezo
	LOW?T	_PIEZO

; C:\USERS\DMITR\DOCUMENTS\GITHUB\UMAB\UMAB_V0_4A_RELEASE.PBP	00481	CCP1CON = 12				'send MT header pulse (2.4mS)
	MOVE?CB	00Ch, CCP1CON

; C:\USERS\DMITR\DOCUMENTS\GITHUB\UMAB\UMAB_V0_4A_RELEASE.PBP	00482	pauseus mtheader  
	PAUSEUS?C	_mtheader

; C:\USERS\DMITR\DOCUMENTS\GITHUB\UMAB\UMAB_V0_4A_RELEASE.PBP	00483	CCP1CON = 0
	MOVE?CB	000h, CCP1CON

; C:\USERS\DMITR\DOCUMENTS\GITHUB\UMAB\UMAB_V0_4A_RELEASE.PBP	00485	message_first_byte:

	LABEL?L	_message_first_byte	

; C:\USERS\DMITR\DOCUMENTS\GITHUB\UMAB\UMAB_V0_4A_RELEASE.PBP	00487	databyte = message_ID | %10000000     		'(packet_ID=1; sys_msg)  
	OR?BCB	_message_ID, 080h, _databyte

; C:\USERS\DMITR\DOCUMENTS\GITHUB\UMAB\UMAB_V0_4A_RELEASE.PBP	00488	GoSub send_byte
	GOSUB?L	_send_byte

; C:\USERS\DMITR\DOCUMENTS\GITHUB\UMAB\UMAB_V0_4A_RELEASE.PBP	00490	message_second_byte:

	LABEL?L	_message_second_byte	

; C:\USERS\DMITR\DOCUMENTS\GITHUB\UMAB\UMAB_V0_4A_RELEASE.PBP	00492	databyte = message 			      
	MOVE?BB	_message, _databyte

; C:\USERS\DMITR\DOCUMENTS\GITHUB\UMAB\UMAB_V0_4A_RELEASE.PBP	00493	GoSub send_byte
	GOSUB?L	_send_byte

; C:\USERS\DMITR\DOCUMENTS\GITHUB\UMAB\UMAB_V0_4A_RELEASE.PBP	00495	message_third_byte:

	LABEL?L	_message_third_byte	

; C:\USERS\DMITR\DOCUMENTS\GITHUB\UMAB\UMAB_V0_4A_RELEASE.PBP	00497	databyte = protocol
	MOVE?CB	_protocol, _databyte

; C:\USERS\DMITR\DOCUMENTS\GITHUB\UMAB\UMAB_V0_4A_RELEASE.PBP	00498	GoSub send_byte
	GOSUB?L	_send_byte

; C:\USERS\DMITR\DOCUMENTS\GITHUB\UMAB\UMAB_V0_4A_RELEASE.PBP	00500	return
	RETURN?	

; C:\USERS\DMITR\DOCUMENTS\GITHUB\UMAB\UMAB_V0_4A_RELEASE.PBP	00503	send_byte:						'send 8 bits (databyte)

	LABEL?L	_send_byte	

; C:\USERS\DMITR\DOCUMENTS\GITHUB\UMAB\UMAB_V0_4A_RELEASE.PBP	00505	For bit_counter = 1 TO 8	'send 8 data bits MSB first
	MOVE?CB	001h, _bit_counter
	LABEL?L	L00073	
	CMPGT?BCL	_bit_counter, 008h, L00074

; C:\USERS\DMITR\DOCUMENTS\GITHUB\UMAB\UMAB_V0_4A_RELEASE.PBP	00506		pauseus mtspace     'send space -- space between data pulses  
	PAUSEUS?C	_mtspace

; C:\USERS\DMITR\DOCUMENTS\GITHUB\UMAB\UMAB_V0_4A_RELEASE.PBP	00507		IF databyte.7 = 1 Then trans1
	CMPEQ?TCL	_databyte??7, 001h, _trans1

; C:\USERS\DMITR\DOCUMENTS\GITHUB\UMAB\UMAB_V0_4A_RELEASE.PBP	00508		CCP1CON = 12		'send zero
	MOVE?CB	00Ch, CCP1CON

; C:\USERS\DMITR\DOCUMENTS\GITHUB\UMAB\UMAB_V0_4A_RELEASE.PBP	00509		pauseus mtbit0  
	PAUSEUS?C	_mtbit0

; C:\USERS\DMITR\DOCUMENTS\GITHUB\UMAB\UMAB_V0_4A_RELEASE.PBP	00510		CCP1CON = 0
	MOVE?CB	000h, CCP1CON

; C:\USERS\DMITR\DOCUMENTS\GITHUB\UMAB\UMAB_V0_4A_RELEASE.PBP	00511		@ rlf	_databyte,F		

	ASM?
 rlf	_databyte,F		

	ENDASM?


; C:\USERS\DMITR\DOCUMENTS\GITHUB\UMAB\UMAB_V0_4A_RELEASE.PBP	00512		GoTo bypassx
	GOTO?L	_bypassx

; C:\USERS\DMITR\DOCUMENTS\GITHUB\UMAB\UMAB_V0_4A_RELEASE.PBP	00514	trans1:

	LABEL?L	_trans1	

; C:\USERS\DMITR\DOCUMENTS\GITHUB\UMAB\UMAB_V0_4A_RELEASE.PBP	00516		CCP1CON = 12		'send one
	MOVE?CB	00Ch, CCP1CON

; C:\USERS\DMITR\DOCUMENTS\GITHUB\UMAB\UMAB_V0_4A_RELEASE.PBP	00517		pauseus mtbit1
	PAUSEUS?C	_mtbit1

; C:\USERS\DMITR\DOCUMENTS\GITHUB\UMAB\UMAB_V0_4A_RELEASE.PBP	00518		CCP1CON = 0	
	MOVE?CB	000h, CCP1CON

; C:\USERS\DMITR\DOCUMENTS\GITHUB\UMAB\UMAB_V0_4A_RELEASE.PBP	00519		@ rlf	_databyte,F		

	ASM?
 rlf	_databyte,F		

	ENDASM?


; C:\USERS\DMITR\DOCUMENTS\GITHUB\UMAB\UMAB_V0_4A_RELEASE.PBP	00521	bypassx:

	LABEL?L	_bypassx	

; C:\USERS\DMITR\DOCUMENTS\GITHUB\UMAB\UMAB_V0_4A_RELEASE.PBP	00523	Next bit_counter
	NEXT?BCL	_bit_counter, 001h, L00073
	LABEL?L	L00074	

; C:\USERS\DMITR\DOCUMENTS\GITHUB\UMAB\UMAB_V0_4A_RELEASE.PBP	00525	Return
	RETURN?	

; C:\USERS\DMITR\DOCUMENTS\GITHUB\UMAB\UMAB_V0_4A_RELEASE.PBP	00529	End
	END?	

	END
